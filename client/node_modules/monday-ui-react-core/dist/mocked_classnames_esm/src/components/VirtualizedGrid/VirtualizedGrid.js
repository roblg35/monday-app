import{slicedToArray as r}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{jsx as e}from"react/jsx-runtime";import{forwardRef as t,useState as n,useRef as o,useCallback as i,useMemo as l,useEffect as u}from"react";import c from"classnames";import{VariableSizeGrid as s}from"react-window";import a from"react-virtualized-auto-sizer";import{getNormalizedItems as d,getOnItemsRenderedData as f,isLayoutDirectionScrollbarVisible as m}from"../../services/virtualized-service.js";import v from"../../hooks/usePrevious/index.js";import h from"../../hooks/useThrottledCallback.js";import g from"../../hooks/useMergeRefs.js";import{NOOP as p}from"../../utils/function-utils.js";import"./VirtualizedGrid.scss.js";var I=t((function(t,I){var w=t.className,b=t.id,x=t.items,j=void 0===x?[]:x,S=t.itemRenderer,T=void 0===S?function(r,e,t){return r}:S,z=t.getRowHeight,C=void 0===z?function(){return 50}:z,N=t.getColumnWidth,R=void 0===N?function(){return 100}:N,M=t.getItemId,O=void 0===M?function(r,e){return r.id}:M,k=t.onScroll,y=t.scrollToId,H=void 0===y?null:y,V=t.onScrollToFinished,W=void 0===V?p:V,A=t.onItemsRendered,F=void 0===A?null:A,P=t.onItemsRenderedThrottleMs,U=void 0===P?200:P,_=t.onSizeUpdate,q=void 0===_?p:_,B=t.onVerticalScrollbarVisiblityChange,D=void 0===B?null:B,G=t.scrollableClassName,E=n(0),J=r(E,2),K=J[0],L=J[1],Q=n(0),X=r(Q,2),Y=X[0],Z=X[1],$=v(H),rr=o(null),er=o(null),tr=o(null),nr=o(0),or=o({scrollOffsetInitial:0,scrollOffsetFinal:0,animationStartTime:0}),ir=g({refs:[I,rr]}),lr=or.current,ur=i((function(r){var e=C();return e&&!Number.isNaN(e)||console.error("Couldn't get height for item: ",r),e}),[C]),cr=i((function(r,e){var t=O(r,e);return void 0===t&&console.error("Couldn't get id for item: ",r),t}),[O]),sr=l((function(){return d(j,cr,ur)}),[j,cr,ur]),ar=l((function(){return Math.min(j.length,Math.floor(Y/R()))}),[j,Y,R]),dr=l((function(){return ar>0?Math.ceil(j.length/ar):0}),[j,ar]),fr=l((function(){return H%ar}),[H,ar]),mr=l((function(){return Math.floor(H/ar)}),[H,ar]),vr=i((function(r){var e=r.horizontalScrollDirection,t=r.scrollTop,n=r.scrollUpdateWasRequested;nr.current=t,n||(lr.scrollOffsetInitial=t),k&&k(e,t,n)}),[k,nr,lr]),hr=i((function(r){var e=r.rowIndex*ar+r.columnIndex;return T(j[e],e,r.style)}),[j,T,ar]),gr=i((function(r,e){e===K&&r===Y||setTimeout((function(){L(e),Z(r),q(r,e)}),0)}),[K,Y,q]),pr=h((function(r){if(F){var e=f(j,sr,cr,r.visibleStartIndex,r.visibleStopIndex,K,nr.current);F(e)}}),{wait:U,trailing:!0},[F,j,sr,cr,K]);return u((function(){H&&$!==H&&(tr.current.scrollToItem({align:"center",columnIndex:fr,rowIndex:mr}),W())}),[H,$,tr,fr,mr,W]),u((function(){tr.current&&tr.current.resetAfterIndices({columnIndex:0,rowIndex:0})}),[sr]),u((function(){if(D){var r=m(j,sr,cr,K);er.current!==r&&(er.current=r,D(r))}}),[D,j,sr,K,cr]),e("div",Object.assign({ref:ir,className:c("virtualized-grid--wrapper",w),id:b},{children:e(a,{children:function(r){var t=r.height,n=r.width;return gr(n,t),e(s,Object.assign({ref:tr,height:t,width:n,columnWidth:R,columnCount:ar,rowHeight:C,rowCount:dr,onScroll:vr,onItemsRendered:pr,className:c("virtualized-grid-scrollable-container",G)},{children:hr}))}})}))}));export{I as default};
