import{slicedToArray as e}from"../../../../_virtual/_rollupPluginBabelHelpers.js";import{jsxs as n,jsx as o}from"react/jsx-runtime";import i,{forwardRef as t,useRef as s,useEffect as r,useLayoutEffect as l,useCallback as a,useMemo as c}from"react";import{DialogPosition as m}from"../../../constants/positions.js";import{isFunction as u}from"lodash-es";import d from"classnames";import p from"../../Tooltip/Tooltip.js";import v from"../../Icon/Icon.js";import y from"../../Icon/Icons/components/DropdownChevronRight.js";import b from"../../DialogContentContainer/DialogContentContainer.js";import f from"../../../hooks/useMergeRefs.js";import h from"../../../hooks/useIsOverflowing/useIsOverflowing.js";import I from"../../../hooks/usePopover.js";import{backwardCompatibilityForProperties as j}from"../../../helpers/backwardCompatibilityForProperties.js";import g from"./hooks/useMenuItemMouseEvents.js";import M from"./hooks/useMenuItemKeyboardEvents.js";import{TAB_INDEX_FOCUS_WITH_JS_ONLY as O}from"./MenuItemConstants.js";import"./MenuItem.scss.js";var C=t((function(t,m){var _,S=t.iconWrapperClassName,x=t.title,k=void 0===x?"":x,N=t.label,w=void 0===N?"":N,E=t.icon,D=void 0===E?"":E,T=t.menuRef,A=t.iconType,L=t.iconBackgroundColor,P=t.disabled,R=void 0!==P&&P,V=t.disableReason,B=t.selected,F=void 0!==B&&B,z=t.onClick,G=t.activeItemIndex,H=void 0===G?-1:G,q=t.setActiveItemIndex,K=t.index,W=t.key,J=t.id,Q=t.menuId,U=t.children,X=t.isParentMenuVisible,Y=void 0!==X&&X,Z=t.resetOpenSubMenuIndex,$=t.hasOpenSubMenu,ee=void 0!==$&&$,ne=t.setSubMenuIsOpenByIndex,oe=t.closeMenu,ie=t.useDocumentEventListeners,te=void 0!==ie&&ie,se=t.tooltipContent,re=t.tooltipPosition,le=void 0===re?C.tooltipPositions.RIGHT:re,ae=t.tooltipShowDelay,ce=void 0===ae?300:ae,me=t.isInitialSelectedState,ue=t.onMouseEnter,de=t.onMouseLeave,pe=t.shouldScrollMenu,ve=j([t.className,t.classname]),ye=H===K,be=!!U&&ye&&ee,fe=!!U,he=fe&&Y&&be,Ie=U&&i.Children.only(U);Ie&&Ie.type&&Ie.type.isMenu?_=Ie:Ie&&console.error("menu item can accept only menu element as first level child, this element is not valid: ",Ie);var je=s(),ge=s(),Me=s(null),Oe=s(null),Ce=Oe.current,_e=Me.current,Se=ge.current,xe=h({ref:je}),ke=I(_e,Ce,{isOpen:be}),Ne=ke.styles,we=ke.attributes;r((function(){var e;ye&&pe&&_e&&(_e.scrollIntoViewIfNeeded?_e.scrollIntoViewIfNeeded({behaviour:"smooth"}):null===(e=_e.scrollIntoView)||void 0===e||e.call(_e,{behavior:"smooth",block:"center"}))}),[ye,_e,pe]);var Ee=g({ref:Me,resetOpenSubMenuIndex:Z,setSubMenuIsOpenByIndex:ne,isActive:ye,setActiveItemIndex:q,index:K,hasChildren:fe}),De=M({onClick:z,disabled:R,isActive:ye,index:K,setActiveItemIndex:q,hasChildren:fe,shouldShowSubMenu:he,setSubMenuIsOpenByIndex:ne,menuRef:T,isMouseEnter:Ee,closeMenu:oe,useDocumentEventListeners:te}).onClickCallback;l((function(){te||he&&Se&&requestAnimationFrame((function(){Se.focus()}))}),[he,Se,te]),r((function(){te||ye&&(null==_e||_e.focus())}),[ye,_e,te]);var Te=a((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ne(K,!1),e.propagate&&oe(e)}),[ne,K,oe]),Ae=f({refs:[m,Me]}),Le=c((function(){return L?[{backgroundColor:L,borderRadius:"4px",width:20,height:20,opacity:R?.4:1},{color:"var(--text-color-on-primary)"}]:[void 0,void 0]}),[L,R]),Pe=e(Le,2),Re=Pe[0],Ve=Pe[1],Be=c((function(){return U?{"aria-haspopup":!0,"aria-expanded":ee}:{}}),[U,ee]),Fe=xe||R||se,ze=c((function(){return R?V:se||k}),[V,R,k,se]);return n("li",Object.assign({id:J||"".concat(Q,"-").concat(K)},Be,{className:d("monday-style-menu-item",ve,{"monday-style-menu-item--disabled":R,"monday-style-menu-item--focused":ye,"monday-style-menu-item--selected":F,"monday-style-menu-item-initial-selected":me}),ref:Ae,onClick:De,role:"menuitem","aria-current":ye,onMouseLeave:de,onMouseEnter:ue,tabIndex:O},{children:[function(){if(!D)return null;var e=A;return e||(e=u(D)?v.type.SVG:v.type.ICON_FONT),o("div",Object.assign({className:d("monday-style-menu-item__icon-wrapper",S),style:Re},{children:o(v,{iconType:e,clickable:!1,icon:D,iconLabel:k,className:"monday-style-menu-item__icon",ignoreFocusStyle:!0,style:Ve,iconSize:20})}))}(),o(p,Object.assign({content:Fe?ze:null,position:le,showDelay:ce},{children:o("div",Object.assign({ref:je,className:"monday-style-menu-item__title"},{children:k}))})),w&&o("div",Object.assign({ref:je,className:"monday-style-menu-item__label"},{children:w})),fe?o("div",Object.assign({className:"monday-style-menu-item__sub_menu_icon-wrapper"},{children:o(v,{clickable:!1,icon:y,iconLabel:k,className:"monday-style-menu-item__sub_menu_icon",ignoreFocusStyle:!0,iconSize:20})})):null,o("div",Object.assign({style:Object.assign(Object.assign({},Ne.popper),{visibility:he?"visible":"hidden"})},we.popper,{className:"monday-style-menu-item__popover",ref:Oe},{children:_&&he&&o(b,{children:i.cloneElement(_,Object.assign(Object.assign({},null==_?void 0:_.props),{isVisible:he,isSubMenu:!0,onClose:Te,ref:ge,useDocumentEventListeners:te}))})}))]}),W)}));Object.assign(C,{iconType:v.type,tooltipPositions:m,isSelectable:!0,isMenuChild:!0});var _=C;export{_ as default};
