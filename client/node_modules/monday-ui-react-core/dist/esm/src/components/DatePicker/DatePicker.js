import{slicedToArray as e,defineProperty as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{jsx as a,jsxs as n,Fragment as i}from"react/jsx-runtime";import{forwardRef as r,useState as o,useCallback as s}from"react";import d from"classnames";import c from"moment";import"react-dates/initialize";import"react-dates/lib/css/_datepicker.css";import{DayPickerRangeController as u,DayPickerSingleDateController as m}from"react-dates";import l from"./DatePickerHeader/DatePickerHeader.js";import f from"./DateNavigationItem/DateNavigationItem.js";import D from"./YearPicker/YearPicker.js";import{WEEK_FIRST_DAY as v,DAY_SIZE as h}from"./constants.js";import{FocusInput as k,Direction as p}from"./types.js";import{getTestId as g}from"../../tests/testIds.js";import{ComponentDefaultTestId as y}from"../../tests/constants.js";import{NOOP as b}from"../../utils/function-utils.js";import P from"./DatePicker.module.scss.js";var j=r((function(r,j){var O,E=r.id,N=r.className,C=r.firstDayOfWeek,I=void 0===C?v:C,M=r.daySize,K=void 0===M?h:M,R=r.range,S=void 0!==R&&R,T=r.shouldBlockDay,W=r.shouldBlockYear,Y=r.numberOfMonths,A=void 0===Y?1:Y,B=r.hideNavigationKeys,x=void 0!==B&&B,_=r.date,z=r.endDate,H=r.onPickDate,w=r.enableOutsideDays,F=void 0!==w&&w,V=r.showWeekNumber,L=void 0!==V&&V,q=r.shouldBlockRange,G=r["data-testid"],J=o(k.startDate),Q=e(J,2),U=Q[0],X=Q[1],Z=o(!1),$=e(Z,2),ee=$[0],te=$[1],ae=o(null),ne=e(ae,2),ie=ne[0],re=ne[1],oe=s((function(e){var t=e.month;return a(l,{"data-testid":G||g(y.DATEPICKER_HEADER,E),currentDate:t||c(),isMonthYearSelection:ee,onToggleMonthYearPicker:function(){return te((function(e){return!e}))},hideNavigationKeys:x})}),[G,ee,x,E]),se=s((function(e){var t=0===I?e.clone().add(1,"d").isoWeek():e.isoWeek();return n(i,{children:[a("span",Object.assign({className:P.calendarDayWeekNumber},{children:t}))," ",e.format("D")]})}),[I]),de=s((function(e){re(e),te(!1)}),[]),ce=s((function(){return a(D,{"data-testid":G||g(y.DATEPICKER_YEAR_SELECTION,E),selectedDate:_,isYearBlocked:W,changeCurrentDate:de})}),[G,W,de,_,E]),ue=s((function(e){H(U===k.startDate?Object.assign(Object.assign({},e),{endDate:null}):e)}),[U,H]),me=s((function(e){X(e||k.startDate)}),[]),le=!x&&!ee;return n("div",Object.assign({"data-testid":G||g(y.DATEPICKER,E),ref:j,id:E,className:d(P.datepickerContainer,N,(O={},t(O,P.withWeekNumber,L),t(O,P.rangePickerMode,S),t(O,P.monthYearSelection,ee),O))},{children:[S?a(u,{renderDayContents:L?se:void 0,firstDayOfWeek:I,hideKeyboardShortcutsPanel:!0,startDate:_,endDate:z,onDatesChange:ue,focusedInput:U,minimumNights:0,onFocusChange:me,navPrev:le?a(f,{kind:p.prev}):a("div",{}),navNext:le?a(f,{kind:p.next}):a("div",{}),daySize:K,isOutsideRange:q,isDayBlocked:T,renderMonthElement:oe,enableOutsideDays:F||L,numberOfMonths:A,initialVisibleMonth:function(){return ie||_||c()}},"".concat(null==ie?void 0:""+ie)):a(m,{renderDayContents:L?se:void 0,firstDayOfWeek:I,hideKeyboardShortcutsPanel:!0,onFocusChange:b,numberOfMonths:A,date:_,onDateChange:function(e){return H(e)},navPrev:le?a(f,{kind:p.prev}):a("div",{}),navNext:le?a(f,{kind:p.next}):a("div",{}),focused:!0,renderMonthElement:oe,enableOutsideDays:F||L,daySize:K,isDayBlocked:T,initialVisibleMonth:function(){return ie||_||c()}},"".concat(null==ie?void 0:""+ie)),ee&&ce()]}))}));Object.assign(j,{defaultTestId:y.DATEPICKER});var O=j;export{O as default};
